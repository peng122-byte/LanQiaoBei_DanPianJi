# æ¸©åº¦é‡‡é›†å™¨é¡¹ç›®å¯¹æ¯”åˆ†ææŠ¥å‘Š

## ğŸ“‹ å¯¹æ¯”æ¦‚è§ˆ

æœ¬æŠ¥å‘Šå¯¹æ¯”åˆ†æäº†ä¸¤ä¸ªé¡¹ç›®ï¼š
- **é¡¹ç›®Aï¼ˆä½ çš„é¡¹ç›®ï¼‰**ï¼š`demo5/User/main.c`ï¼ˆ451è¡Œï¼‰
- **é¡¹ç›®Bï¼ˆèŒƒä¾‹ç¨‹åºï¼‰**ï¼š`è¿‡æ¸¡è®­ç»ƒ - èŒƒä¾‹ç¨‹åº/User/main.c`ï¼ˆ293è¡Œï¼‰

---

## âœ… ç›¸åŒç‚¹æ€»ç»“

### 1. æ•´ä½“æ¶æ„
| ç‰¹æ€§ | é¡¹ç›®A | é¡¹ç›®B | ä¸€è‡´æ€§ |
|------|-------|-------|--------|
| åˆ†å±‚è®¾è®¡ | Driver + User | Driver + User | âœ… å®Œå…¨ç›¸åŒ |
| ä¸‰ç§å·¥ä½œæ¨¡å¼ | è¾“å…¥/æ˜¾ç¤º/è®¾ç½® | è¾“å…¥/æ˜¾ç¤º/è®¾ç½® | âœ… å®Œå…¨ç›¸åŒ |
| å•ç‰‡æœºå‹å· | AT89C52 | AT89C52 | âœ… å®Œå…¨ç›¸åŒ |
| æ™¶æŒ¯é¢‘ç‡ | 12MHz | 12MHz | âœ… å®Œå…¨ç›¸åŒ |

### 2. é©±åŠ¨å±‚ä»£ç 
**é‡è¦å‘ç°**ï¼šä¸‰ä¸ªé©±åŠ¨æ–‡ä»¶**å®Œå…¨ç›¸åŒ**ï¼

| æ–‡ä»¶ | ä»£ç è¡Œæ•° | åŠŸèƒ½ | å¯¹æ¯”ç»“æœ |
|------|----------|------|----------|
| Key.c | 27è¡Œ | 4Ã—4çŸ©é˜µé”®ç›˜æ‰«æ | âœ… 100%ç›¸åŒ |
| Led.c | 17è¡Œ | 8ä½LEDé©±åŠ¨ | âœ… 100%ç›¸åŒ |
| Seg.c | 22è¡Œ | 6ä½æ•°ç ç®¡é©±åŠ¨ | âœ… 100%ç›¸åŒ |

**ä»£ç å¯¹æ¯”ç¤ºä¾‹**ï¼š
```c
// Key.c - ä¸¤ä¸ªé¡¹ç›®å®Œå…¨ä¸€è‡´
unsigned char Key_Read()
{
    unsigned char temp = 0;
    P3_0 = 0; P3_1 = 1; P3_2 = 1; P3_3 = 1;
    if(P3_4 == 0) temp = 1;
    // ... å®Œå…¨ç›¸åŒ
}
```

### 3. å®šæ—¶å™¨é…ç½®
```c
// Timer0åˆå§‹åŒ– - ä¸¤ä¸ªé¡¹ç›®å®Œå…¨ä¸€è‡´
void Timer0Init(void)  // @12.000MHz
{
    TMOD &= 0xF0;
    TMOD |= 0x01;
    TL0 = 0x18;  // âœ… ç›¸åŒ
    TH0 = 0xFC;  // âœ… ç›¸åŒ
    // ... å…¶ä»–é…ç½®å®Œå…¨ç›¸åŒ
}
```

### 4. æŒ‰é”®é˜²æŠ–æœºåˆ¶
```c
// ä¸¤ä¸ªé¡¹ç›®éƒ½é‡‡ç”¨è¾¹æ²¿æ£€æµ‹
Key_Val = Key_Read();
Key_Down = Key_Val & (Key_Old ^ Key_Val);  // ä¸‹é™æ²¿
Key_Up = ~Key_Val & (Key_Old ^ Key_Val);   // ä¸Šå‡æ²¿ï¼ˆèŒƒä¾‹ï¼‰
// æˆ–
Key_Up = Key_Old & (Key_Val ^ Key_Old);    // ä¸Šå‡æ²¿ï¼ˆä½ çš„ï¼‰
```

### 5. åŠŸèƒ½æ¨¡å—
| åŠŸèƒ½ | ä¸¤ä¸ªé¡¹ç›®éƒ½æœ‰ |
|------|-------------|
| æ¸©åº¦è¾“å…¥ï¼ˆ0-85â„ƒï¼‰ | âœ… |
| å°æ•°ç‚¹æ”¯æŒ | âœ… |
| å››èˆäº”å…¥å¤„ç† | âœ… |
| å‚æ•°è®¾ç½®ï¼ˆä¸Šä¸‹é™ï¼‰ | âœ… |
| LEDçŠ¶æ€æŒ‡ç¤º | âœ… |
| PWMäº®åº¦æ§åˆ¶ | âœ… |
| é—ªçƒæ•ˆæœ | âœ… |
| é•¿æŒ‰åŠ é€Ÿ | âœ… |

---

## âš ï¸ å·®å¼‚ç‚¹è¯¦è§£

### ã€å·®å¼‚1ã€‘æ¸©åº¦æ•°æ®ç±»å‹ä¸å¤„ç†æ–¹å¼

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šä½¿ç”¨æµ®ç‚¹æ•°
```c
// èŒƒä¾‹ç¨‹åº - ä½¿ç”¨floatç±»å‹
float Temperature;  // å®é™…æ¸©åº¦å˜é‡

// æŒ‰é”®16ç¡®è®¤æ—¶çš„è®¡ç®—é€»è¾‘
Temperature = Seg_Input[0] * 100 + Seg_Input[1] * 10 + Seg_Input[2] + 5;
while(3 - Point_Wela)
{
    Temperature /= 10.0;  // æµ®ç‚¹é™¤æ³•
    Point_Wela++;
}
// ç¤ºä¾‹ï¼šè¾“å…¥36.8
// è®¡ç®—ï¼š(3*100 + 6*10 + 8 + 5) = 373
// Point_Wela=1ï¼Œé™¤1æ¬¡ï¼š373/10 = 37.3
// å››èˆäº”å…¥åæ˜¾ç¤ºï¼š37

// æ˜¾ç¤ºæ—¶ç›´æ¥å–æ•´
Seg_Buf[4] = (unsigned char)Temperature / 10;  // åä½
Seg_Buf[5] = (unsigned char)Temperature % 10;  // ä¸ªä½
```

**ä¼˜ç‚¹**ï¼š
- ä»£ç ç®€æ´
- ç›´è§‚æ˜“æ‡‚
- è‡ªåŠ¨å››èˆäº”å…¥

**ç¼ºç‚¹**ï¼š
- å ç”¨æ›´å¤šRAMï¼ˆ4å­—èŠ‚ï¼‰
- éœ€è¦æµ®ç‚¹è¿ç®—åº“ï¼ˆå¢åŠ ä»£ç ä½“ç§¯ï¼‰
- è¿è¡Œé€Ÿåº¦è¾ƒæ…¢

---

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šä½¿ç”¨æ•´æ•°æ•°ç»„
```c
// ä½ çš„é¡¹ç›® - ä½¿ç”¨unsigned charæ•°ç»„
unsigned char Temperature_Real[3] = {0,0,0};  // ç™¾ã€åã€ä¸ªä½
unsigned int Temperature_Input_Data;          // ä¸´æ—¶è®¡ç®—å˜é‡

// æŒ‰é”®16ç¡®è®¤æ—¶çš„å››èˆäº”å…¥é€»è¾‘
switch(Point_Wei)
{
    case 0:  // æ ¼å¼ï¼šx.xx â†’ ä¿ç•™æ•´æ•°
        Temperature_Real[1] = 0;
        Temperature_Real[2] = Temperature_Input[0];
        if(Temperature_Input[1] >= 5)  // ååˆ†ä½â‰¥5è¿›ä½
        {
            Temperature_Real[2]++;
            if(Temperature_Real[2] == 10)
            {
                Temperature_Real[2] = 0;
                Temperature_Real[1]++;
            }
        }
        break;

    case 1:  // æ ¼å¼ï¼šxx.x â†’ ä¿ç•™ä¸€ä½å°æ•°
        Temperature_Real[1] = Temperature_Input[0];
        Temperature_Real[2] = Temperature_Input[1];
        if(Temperature_Input[2] >= 5)  // ç™¾åˆ†ä½â‰¥5è¿›ä½
        {
            Temperature_Real[2]++;
            // ... è¿›ä½å¤„ç†
        }
        break;

    case 2:  // æ— å°æ•°ç‚¹ â†’ æ¸…é™¤æ•°æ®
        // é‡ç½®é€»è¾‘
        break;
}

// æœ€ç»ˆè½¬æ¢ä¸ºæ•´æ•°
Temperature_Input_Data = Temperature_Real[0]*100 +
                        Temperature_Real[1]*10 +
                        Temperature_Real[2];
```

**ä¼˜ç‚¹**ï¼š
- ä¸éœ€è¦æµ®ç‚¹åº“ï¼ˆä»£ç ä½“ç§¯å°ï¼‰
- è¿è¡Œé€Ÿåº¦å¿«
- RAMå ç”¨å°‘
- ç²¾ç¡®æ§åˆ¶å››èˆäº”å…¥

**ç¼ºç‚¹**ï¼š
- ä»£ç è¾ƒé•¿
- é€»è¾‘å¤æ‚
- éœ€è¦æ‰‹åŠ¨å¤„ç†è¿›ä½

---

### ã€å·®å¼‚2ã€‘å‚æ•°è®¾ç½®çš„æ•°æ®ç»“æ„

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šç´§å‡‘å‹è®¾è®¡
```c
// èŒƒä¾‹ç¨‹åº - å•ç»´æ•°ç»„
unsigned char Parameter[2] = {30, 20};        // ä¸Šé™30â„ƒï¼Œä¸‹é™20â„ƒ
unsigned char Parameter_Ctrol[2] = {30, 20};  // å®é™…ç”Ÿæ•ˆå‚æ•°
bit Parameter_Index;                          // ç´¢å¼•ï¼š0æˆ–1

// å‚æ•°åˆ‡æ¢ï¼ˆæŒ‰é”®13ï¼‰
Parameter_Index ^= 1;  // 0â†”1åˆ‡æ¢

// æ˜¾ç¤ºé€»è¾‘ï¼ˆæ¨¡å¼2ï¼‰
Seg_Buf[2] = Parameter[0] / 10;   // ä¸Šé™åä½
Seg_Buf[3] = Parameter[0] % 10;   // ä¸Šé™ä¸ªä½
Seg_Buf[4] = Parameter[1] / 10;   // ä¸‹é™åä½
Seg_Buf[5] = Parameter[1] % 10;   // ä¸‹é™ä¸ªä½

// é—ªçƒæ•ˆæœï¼šé€šè¿‡Parameter_Indexè®¡ç®—åç§»
Seg_Buf[2 + 2*Parameter_Index] = Seg_Star_Flag ? Parameter[Parameter_Index]/10 : 10;
Seg_Buf[3 + 2*Parameter_Index] = Seg_Star_Flag ? Parameter[Parameter_Index]%10 : 10;
```

**ä¼˜ç‚¹**ï¼š
- æ•°æ®ç»“æ„ç®€æ´
- ç´¢å¼•è®¡ç®—å·§å¦™ï¼ˆ2*Parameter_Indexï¼‰
- å†…å­˜å ç”¨å°‘

---

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šå››ä½æ•°ç»„è®¾è®¡
```c
// ä½ çš„é¡¹ç›® - å››ä½æ•°ç»„
unsigned char Temperature_Setting[4] = {3,0,2,0};      // [ä¸Šé™åä½][ä¸Šé™ä¸ªä½][ä¸‹é™åä½][ä¸‹é™ä¸ªä½]
unsigned char Temperature_Setting_Old[4] = {3,0,2,0};  // å¤‡ä»½æ•°ç»„
unsigned char Temperature_Setting_Index;               // ç´¢å¼•ï¼š0æˆ–2

// å‚æ•°åˆ‡æ¢ï¼ˆæŒ‰é”®13ï¼‰
Temperature_Setting_Index += 2;
if(Temperature_Setting_Index == 4)
    Temperature_Setting_Index = 0;

// æ˜¾ç¤ºé€»è¾‘ï¼ˆæ¨¡å¼2ï¼‰
Seg_Buf[2] = Temperature_Setting[0];  // ä¸Šé™åä½
Seg_Buf[3] = Temperature_Setting[1];  // ä¸Šé™ä¸ªä½
Seg_Buf[4] = Temperature_Setting[2];  // ä¸‹é™åä½
Seg_Buf[5] = Temperature_Setting[3];  // ä¸‹é™ä¸ªä½

// é—ªçƒæ•ˆæœï¼šç›´æ¥åˆ¤æ–­ç´¢å¼•
if(Temperature_Setting_Index == 0)  // ä¿®æ”¹ä¸Šé™
{
    Seg_Buf[2] = 10;
    Seg_Buf[3] = 10;
}
if(Temperature_Setting_Index == 2)  // ä¿®æ”¹ä¸‹é™
{
    Seg_Buf[4] = 10;
    Seg_Buf[5] = 10;
}
```

**ä¼˜ç‚¹**ï¼š
- æ•°æ®ç»“æ„ç›´è§‚
- ç›´æ¥å­˜å‚¨å„ä½æ•°å­—
- æ˜“äºç†è§£å’Œç»´æŠ¤

**ç¼ºç‚¹**ï¼š
- å†…å­˜å ç”¨ç¨å¤š
- éœ€è¦é¢å¤–è½¬æ¢ï¼ˆåˆå¹¶ä¸ºå®Œæ•´æ¸©åº¦å€¼ï¼‰

---

### ã€å·®å¼‚3ã€‘é•¿æŒ‰æ£€æµ‹æœºåˆ¶

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šåŸºäºæ ‡å¿—ä½çš„è®¡æ—¶
```c
// èŒƒä¾‹ç¨‹åº - ä½¿ç”¨è®¡æ—¶æ ‡å¿—
bit Time_Flag;             // è®¡æ—¶å¯åŠ¨æ ‡å¿—
unsigned int Count_500Ms;  // è®¡æ—¶ç´¯åŠ å™¨

// æŒ‰é”®å¤„ç†
if(Key_Down == 14)
    Time_Flag = 1;  // å¯åŠ¨è®¡æ—¶

if(Count_500Ms < 500)  // çŸ­æŒ‰åˆ¤æ–­
{
    if(Key_Up == 14)
    {
        Time_Flag = Count_500Ms = 0;  // å¤ä½
        Parameter[Parameter_Index]++;  // å•æ¬¡åŠ 1
    }
}
else  // é•¿æŒ‰åˆ¤æ–­ï¼ˆâ‰¥500msï¼‰
{
    if(Key_Old == 14)
    {
        Parameter[Parameter_Index]++;  // è¿ç»­åŠ 1
    }
    if(Key_Up == 14)
        Time_Flag = Count_500Ms = 0;
}

// å®šæ—¶å™¨ä¸­æ–­
if(Time_Flag == 1)
{
    if(++Count_500Ms == 600)  // é™åˆ¶ä¸Šé™
        Count_500Ms = 600;
}
```

**ç‰¹ç‚¹**ï¼š
- æŒ‰ä¸‹æ—¶å¯åŠ¨è®¡æ—¶
- 500msä¸ºé˜ˆå€¼
- ä¸Šé™ä¿æŠ¤600ms
- æ”¯æŒçŸ­æŒ‰å’Œé•¿æŒ‰ä¸¤ç§è¡Œä¸º

---

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šç‹¬ç«‹è®¡æ•°å™¨
```c
// ä½ çš„é¡¹ç›® - æ¯ä¸ªæŒ‰é”®ç‹¬ç«‹è®¡æ•°
unsigned int Key_Long0;  // æŒ‰é”®14é•¿æŒ‰è®¡æ•°
unsigned int Key_Long1;  // æŒ‰é”®15é•¿æŒ‰è®¡æ•°

// æŒ‰é”®å¤„ç†
if(Key_Down == 14)  // çŸ­æŒ‰
{
    Temperature_Setting[Temperature_Setting_Index + 1]++;
    // ... è¿›ä½å¤„ç†
}

if(Key_Old == 14)  // é•¿æŒ‰åˆ¤æ–­
{
    if(Key_Long0 >= 500)  // é˜ˆå€¼500ms
    {
        Temperature_Setting[Temperature_Setting_Index + 1]++;
        // ... è¿›ä½å¤„ç†
    }
}

// å®šæ—¶å™¨ä¸­æ–­
if(Key_Old == 14)
    Key_Long0++;
else
    Key_Long0 = 0;

if(Key_Old == 15)
    Key_Long1++;
else
    Key_Long1 = 0;
```

**ç‰¹ç‚¹**ï¼š
- æ¯ä¸ªæŒ‰é”®ç‹¬ç«‹è®¡æ•°å™¨
- å§‹ç»ˆç´¯åŠ ï¼Œä¸éœ€è¦å¯åŠ¨æ ‡å¿—
- 500msé˜ˆå€¼
- çŸ­æŒ‰å’Œé•¿æŒ‰éƒ½ä¼šæ‰§è¡Œç›¸åŒæ“ä½œ

---

### ã€å·®å¼‚4ã€‘æ•°ç ç®¡åˆ·æ–°å‘¨æœŸ

| é¡¹ç›® | æŒ‰é”®æ‰«æ | æ•°ç ç®¡åˆ·æ–° | é—ªçƒå‘¨æœŸ |
|------|----------|-----------|----------|
| é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ | 10ms | **10ms** | **500ms** |
| é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ | 10ms | **50ms** | **250ms** |

```c
// èŒƒä¾‹ç¨‹åº
if(++Seg_Slow_Down == 10) Seg_Slow_Down = 0;  // 10msåˆ·æ–°
if(++Timer_500Ms == 500) { ... }              // 500msé—ªçƒ

// ä½ çš„é¡¹ç›®
if(++Seg_Slow_Down == 50) Seg_Slow_Down = 0;  // 50msåˆ·æ–°
if(++Time250 == 250) { ... }                  // 250msé—ªçƒ
```

**åˆ†æ**ï¼š
- **æ•°ç ç®¡åˆ·æ–°**ï¼š
  - èŒƒä¾‹10msï¼šå“åº”æ›´å¿«ï¼Œä½†ä¸»å¾ªç¯å‹åŠ›è¾ƒå¤§
  - ä½ çš„50msï¼šå‡å°‘CPUå ç”¨ï¼Œå“åº”ç¨æ…¢ä½†è¶³å¤Ÿ

- **é—ªçƒå‘¨æœŸ**ï¼š
  - èŒƒä¾‹500msï¼šèŠ‚å¥èˆ’ç¼“
  - ä½ çš„250msï¼šèŠ‚å¥æ›´å¿«ï¼Œè§†è§‰åé¦ˆæ›´æ˜æ˜¾

---

### ã€å·®å¼‚5ã€‘LEDæ§åˆ¶é€»è¾‘çš„å®ç°æ–¹å¼

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šä½è¿ç®—è¡¨è¾¾å¼
```c
// èŒƒä¾‹ç¨‹åº - ç®€æ´ä½†éš¾æ‡‚çš„ä½è¿ç®—
void Led_Proc()
{
    // PWMç­‰çº§è®¡ç®—ï¼ˆæ³¨é‡Šæ‰çš„ç‰ˆæœ¬ï¼‰
    // Led_Pwm = 3 * (1*((int)Temperature/Parameter_Ctrol[0]) +
    //                2*((!((int)Temperature/Parameter_Ctrol[0])) & ((int)Temperature/Parameter_Ctrol[1])) +
    //                3*(!((int)Temperature/Parameter_Ctrol[1])));

    // å½“å‰ä½¿ç”¨çš„if-elseç‰ˆæœ¬
    if(Temperature > Parameter_Ctrol[0])
        Led_Pwm = 3;
    else if(Temperature < Parameter_Ctrol[0] && Temperature > Parameter_Ctrol[1])
        Led_Pwm = 6;
    else
        Led_Pwm = 9;

    // LEDçŠ¶æ€è®¡ç®— - ä½¿ç”¨ä½è¿ç®—
    ucLed[0] = (int)Temperature / Parameter_Ctrol[0];  // æ¸©åº¦>ä¸Šé™ â†’ 1
    ucLed[1] = (!((int)Temperature / Parameter_Ctrol[0])) &
               ((int)Temperature / Parameter_Ctrol[1]);  // åœ¨èŒƒå›´å†… â†’ 1
    ucLed[2] = !((int)Temperature / Parameter_Ctrol[1]);  // æ¸©åº¦<ä¸‹é™ â†’ 1
    ucLed[3] = Error_Flag;
}
```

**è§£æ**ï¼š
- åˆ©ç”¨æ•´æ•°é™¤æ³•ï¼š`Temperature/Parameter_Ctrol[0]`
  - è‹¥Temperature > Parameter_Ctrol[0]ï¼Œç»“æœâ‰¥1ï¼ˆçœŸï¼‰
  - è‹¥Temperature < Parameter_Ctrol[0]ï¼Œç»“æœ=0ï¼ˆå‡ï¼‰
- ä½¿ç”¨é€»è¾‘éå’Œä½ä¸ç»„åˆåˆ¤æ–­èŒƒå›´

**ä¼˜ç‚¹**ï¼šä»£ç ç®€æ´ï¼ˆ4è¡Œï¼‰
**ç¼ºç‚¹**ï¼šå¯è¯»æ€§å·®ï¼Œéš¾ä»¥ç»´æŠ¤

---

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šæ¸…æ™°çš„æ¡ä»¶åˆ¤æ–­
```c
// ä½ çš„é¡¹ç›® - ç›´è§‚çš„if-else
void Led_Proc()
{
    // LED0ï¼šæ¸©åº¦è¶…è¿‡ä¸Šé™
    if(Temperature_Data > TMAX)
    {
        Led_Level = 3;
        ucLed[0] = 1;
    }
    else
    {
        ucLed[0] = 0;
    }

    // LED1ï¼šæ¸©åº¦åœ¨èŒƒå›´å†…
    if((Temperature_Data >= TMIN) && (Temperature_Data <= TMAX))
    {
        Led_Level = 6;
        ucLed[1] = 1;
    }
    else
    {
        ucLed[1] = 0;
    }

    // LED2ï¼šæ¸©åº¦ä½äºä¸‹é™
    if(Temperature_Data < TMIN)
    {
        Led_Level = 9;
        ucLed[2] = 1;
    }
    else
    {
        ucLed[2] = 0;
    }

    // LED3ï¼šæ•°æ®é”™è¯¯æ ‡å¿—
    if(Data_Error == 1)
    {
        ucLed[3] = 1;
    }
    else
    {
        ucLed[3] = 0;
    }
}
```

**ä¼˜ç‚¹**ï¼šé€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œè°ƒè¯•
**ç¼ºç‚¹**ï¼šä»£ç è¾ƒé•¿ï¼ˆ34è¡Œï¼‰

---

### ã€å·®å¼‚6ã€‘PWMäº®åº¦ç­‰çº§çš„å˜é‡å‘½å

| é¡¹ç›® | PWMè®¡æ•°å™¨ | PWMé˜ˆå€¼ |
|------|-----------|---------|
| é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ | `Led_Num` | `Led_Pwm` |
| é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ | `Led_PWM` | `Led_Level` |

```c
// èŒƒä¾‹ç¨‹åº
if(++Led_Num == 10) Led_Num = 0;
if(Led_Num < Led_Pwm)
    Led_Disp(Led_Pos, ucLed[Led_Pos]);
else
    Led_Disp(Led_Pos, 0);

// ä½ çš„é¡¹ç›®
if(++Led_PWM == 10) Led_PWM = 0;
if(Led_PWM < Led_Level)
    Led_Disp(Led_Pos, ucLed[Led_Pos]);
else
    Led_Disp(Led_Pos, 0);
```

**è¯­ä¹‰åˆ†æ**ï¼š
- èŒƒä¾‹ï¼š`Led_Num`ï¼ˆè®¡æ•°å™¨ï¼‰ï¼Œ`Led_Pwm`ï¼ˆé˜ˆå€¼ï¼‰
- ä½ çš„ï¼š`Led_PWM`ï¼ˆè®¡æ•°å™¨ï¼‰ï¼Œ`Led_Level`ï¼ˆé˜ˆå€¼ï¼‰
- **ä½ çš„å‘½åæ›´åˆç†**ï¼š`Led_Level`æ˜ç¡®è¡¨ç¤º"äº®åº¦ç­‰çº§"

---

### ã€å·®å¼‚7ã€‘æ¸©åº¦è¾“å…¥éªŒè¯è§„åˆ™

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šå¼ºåˆ¶å°æ•°ç‚¹
```c
if(Point_Flag == 0 || Seg_Input_Index < 3)
{
    // å°æ•°ç‚¹æœªä½¿èƒ½ æˆ– è¾“å…¥ä¸è¶³3ä½ â†’ æ— æ•ˆæ•°æ®
    // æ¸…é™¤è¾“å…¥ï¼Œé‡æ–°å¼€å§‹
}
else
{
    // å°æ•°ç‚¹å·²ä½¿èƒ½ ä¸” è¾“å…¥3ä½ â†’ æœ‰æ•ˆæ•°æ®
    Temperature = Seg_Input[0]*100 + Seg_Input[1]*10 + Seg_Input[2] + 5;
    // ... å››èˆäº”å…¥å¤„ç†
}
```

**è§„åˆ™**ï¼š
- âœ… å¿…é¡»è¾“å…¥å°æ•°ç‚¹ï¼ˆå¦‚ï¼š3.25ã€3.2ï¼‰
- âœ… å¿…é¡»è¾“å…¥3ä½æ•°å­—
- âŒ ä¸èƒ½è¾“å…¥æ•´æ•°ï¼ˆå¦‚ï¼š32ï¼‰

**ç¤ºä¾‹**ï¼š
- âœ… è¾“å…¥ï¼š3 â†’ 2 â†’ . â†’ 5 â†’ 16 â†’ æˆåŠŸï¼ˆ32.5â„ƒ â†’ æ˜¾ç¤º33â„ƒï¼‰
- âŒ è¾“å…¥ï¼š3 â†’ 2 â†’ 16 â†’ å¤±è´¥ï¼ˆæ¸…é™¤é‡è¾“ï¼‰

---

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šçµæ´»å¤„ç†
```c
switch(Point_Wei)
{
    case 0:  // æ ¼å¼ï¼šx.xx
        // å››èˆäº”å…¥ä¸ºæ•´æ•°
        break;
    case 1:  // æ ¼å¼ï¼šxx.x
        // ä¿ç•™ä¸€ä½å°æ•°
        break;
    case 2:  // æ— å°æ•°ç‚¹
        // æŒ‰16ç¬¬ä¸€æ¬¡ï¼šæ¸…é™¤æ•°æ®
        // æŒ‰16ç¬¬äºŒæ¬¡ï¼šè¿”å›æ¨¡å¼0
        break;
}
```

**è§„åˆ™**ï¼š
- âœ… å¯ä»¥è¾“å…¥å°æ•°ç‚¹ï¼ˆå¦‚ï¼š3.25ï¼‰
- âœ… å¯ä»¥è¾“å…¥æ•´æ•°ï¼ˆæŒ‰16ä¸¤æ¬¡æ¸…é™¤åé‡è¾“ï¼‰
- âœ… æ”¯æŒä¸åŒå°æ•°ä½æ ¼å¼

**ç¤ºä¾‹**ï¼š
- âœ… è¾“å…¥ï¼š3 â†’ 2 â†’ . â†’ 5 â†’ 16 â†’ æˆåŠŸï¼ˆ32.5â„ƒ â†’ æ˜¾ç¤º33â„ƒï¼‰
- âš ï¸ è¾“å…¥ï¼š3 â†’ 2 â†’ 16 â†’ æ¸…é™¤ â†’ é‡æ–°è¾“å…¥

---

### ã€å·®å¼‚8ã€‘æ®µç è¡¨ç´¢å¼•å®šä¹‰

```c
// èŒƒä¾‹ç¨‹åº
// Seg_Dula[] = {0-9, ç©º, -, A, C, P}
//                0-9  10  11  12  13  14
Seg_Buf[0] = 12;  // æ¨¡å¼0æ˜¾ç¤º "A"
Seg_Buf[0] = 13;  // æ¨¡å¼1æ˜¾ç¤º "C"
Seg_Buf[0] = 14;  // æ¨¡å¼2æ˜¾ç¤º "P"

// ä½ çš„é¡¹ç›®
// Seg_Dula[] = {0-9, ç©º, G, A(T), -, C(d), P(S)}
//                0-9  10  11  12   13  14    15
Seg_Buf[0] = 12;  // æ¨¡å¼0æ˜¾ç¤º "T" (å®é™…ç¼–ç æ˜¯A)
Seg_Buf[0] = 14;  // æ¨¡å¼1æ˜¾ç¤º "d" (å®é™…ç¼–ç æ˜¯C)
Seg_Buf[0] = 15;  // æ¨¡å¼2æ˜¾ç¤º "S" (å®é™…ç¼–ç æ˜¯P)
```

**åˆ†æ**ï¼š
- èŒƒä¾‹ï¼šç›´æ¥ä½¿ç”¨Aã€Cã€På­—æ¯
- ä½ çš„ï¼šä½¿ç”¨Tã€dã€Sä½œä¸ºç•Œé¢æ ‡è¯†ï¼ˆæ›´ç›´è§‚ï¼‰
  - T = Temperatureï¼ˆæ¸©åº¦è¾“å…¥ï¼‰
  - d = displayï¼ˆæ•°æ®æ˜¾ç¤ºï¼‰
  - S = Settingï¼ˆå‚æ•°è®¾ç½®ï¼‰

---

### ã€å·®å¼‚9ã€‘ä»£ç æ³¨é‡Šé£æ ¼

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šç®€æ´æ³¨é‡Š
```c
unsigned char Key_Val,Key_Down,Key_Old,Key_Up;//æŒ‰é”®ä¸“ç”¨å˜é‡
unsigned char Seg_Buf[6] = {10,10,10,10,10,10};//æ•°ç ç®¡æ˜¾ç¤ºæ•°æ®å­˜æ”¾æ•°ç»„
```

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šè¯¦ç»†æ³¨é‡Š
```c
unsigned char Key_Val,Key_Down,Key_Old,Key_Up;//æŒ‰é”®ä¸“ç”¨å˜é‡
unsigned char Key_Slow_Down;//æŒ‰é”®å‡é€Ÿä¸“ç”¨å˜é‡
unsigned char Seg_Buf[6] = {10,10,10,10,10,10};//æ•°ç ç®¡æ˜¾ç¤ºæ•°æ®å­˜æ”¾æ•°ç»„
unsigned char Seg_Point[6] = {0,0,0,0,0,0};//æ•°ç ç®¡å°æ•°ç‚¹æ•°æ®å­˜æ”¾æ•°ç»„
unsigned char Seg_Pos;//æ•°ç ç®¡æ‰«æä¸“ç”¨å˜é‡
```

**å¯¹æ¯”**ï¼š
- èŒƒä¾‹ï¼šæ³¨é‡Šç®€æ´ï¼Œå…³æ³¨é‡ç‚¹
- ä½ çš„ï¼šæ¯ä¸ªå˜é‡éƒ½æœ‰æ³¨é‡Šï¼Œæ›´è¯¦ç»†

---

### ã€å·®å¼‚10ã€‘å‚æ•°è°ƒæ•´çš„è¿›ä½é€»è¾‘

#### é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ï¼šå¾ªç¯è¾¹ç•Œ
```c
if(++Parameter[Parameter_Index] > 70)
    Parameter[Parameter_Index] = 10;  // 70 â†’ 10 å¾ªç¯

if(--Parameter[Parameter_Index] == 255)  // unsigned charä¸‹æº¢
    Parameter[Parameter_Index] = 70;     // 10 â†’ 70 å¾ªç¯
```

**ç‰¹ç‚¹**ï¼š
- å‚æ•°èŒƒå›´ï¼š10-70â„ƒ
- è¶…å‡ºè¾¹ç•Œæ—¶å¾ªç¯ï¼ˆ70â†’10ï¼Œ10â†’70ï¼‰

---

#### é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ï¼šåˆ†ä½è°ƒæ•´
```c
Temperature_Setting[Temperature_Setting_Index + 1]++;
if(Temperature_Setting[Temperature_Setting_Index + 1] == 10)
{
    Temperature_Setting[Temperature_Setting_Index + 1] = 0;
    Temperature_Setting[Temperature_Setting_Index]++;  // ä¸ªä½è¿›ä½
}

// ä¸Šé™ä¿æŠ¤ï¼š70â„ƒ
if((Temperature_Setting[Temperature_Setting_Index] == 7) &&
   (Temperature_Setting[Temperature_Setting_Index + 1] == 1))
{
    Temperature_Setting[Temperature_Setting_Index] = 7;
    Temperature_Setting[Temperature_Setting_Index + 1] = 0;
}
```

**ç‰¹ç‚¹**ï¼š
- åˆ†åˆ«å¤„ç†åä½å’Œä¸ªä½
- ä¸ªä½æ»¡10è¿›ä½
- è¾¹ç•Œä¿æŠ¤ï¼ˆä¸Šé™70â„ƒï¼Œä¸‹é™10â„ƒï¼‰

---

## ğŸ“Š ç»¼åˆå¯¹æ¯”è¡¨

| å¯¹æ¯”ç»´åº¦ | é¡¹ç›®Aï¼ˆä½ çš„ï¼‰ | é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰ | æ¨è |
|---------|-------------|-------------|------|
| **ä»£ç è¡Œæ•°** | 451è¡Œ | 293è¡Œ | èŒƒä¾‹æ›´ç®€æ´ |
| **æ¸©åº¦æ•°æ®ç±»å‹** | unsigned charæ•°ç»„ | floatæµ®ç‚¹æ•° | çœ‹éœ€æ±‚ |
| **ä»£ç ä½“ç§¯** | å°ï¼ˆæ— æµ®ç‚¹åº“ï¼‰ | å¤§ï¼ˆéœ€æµ®ç‚¹åº“ï¼‰ | âœ… ä½ çš„ |
| **è¿è¡Œé€Ÿåº¦** | å¿«ï¼ˆæ•´æ•°è¿ç®—ï¼‰ | æ…¢ï¼ˆæµ®ç‚¹è¿ç®—ï¼‰ | âœ… ä½ çš„ |
| **å¯è¯»æ€§** | é«˜ï¼ˆæ¸…æ™°æ¡ä»¶ï¼‰ | ä¸­ï¼ˆä½è¿ç®—ï¼‰ | âœ… ä½ çš„ |
| **å¯ç»´æŠ¤æ€§** | é«˜ï¼ˆæ³¨é‡Šè¯¦ç»†ï¼‰ | ä¸­ï¼ˆæ³¨é‡Šç®€æ´ï¼‰ | âœ… ä½ çš„ |
| **ä»£ç ç®€æ´åº¦** | ä¸­ï¼ˆé€»è¾‘å±•å¼€ï¼‰ | é«˜ï¼ˆè¡¨è¾¾å¼ç®€æ´ï¼‰ | âœ… èŒƒä¾‹ |
| **é•¿æŒ‰æœºåˆ¶** | ç‹¬ç«‹è®¡æ•°å™¨ | æ ‡å¿—ä½è®¡æ—¶ | å„æœ‰ä¼˜åŠ¿ |
| **è¾“å…¥éªŒè¯** | çµæ´»ï¼ˆå¯æ•´æ•°ï¼‰ | ä¸¥æ ¼ï¼ˆå¿…é¡»å°æ•°ç‚¹ï¼‰ | âœ… ä½ çš„ |
| **æ•°ç ç®¡åˆ·æ–°** | 50ms | 10ms | çœ‹éœ€æ±‚ |
| **é—ªçƒå‘¨æœŸ** | 250ms | 500ms | çœ‹éœ€æ±‚ |
| **å˜é‡å‘½å** | Led_Levelï¼ˆæ¸…æ™°ï¼‰ | Led_Pwmï¼ˆç®€æ´ï¼‰ | âœ… ä½ çš„ |

---

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### å¯¹é¡¹ç›®Aï¼ˆä½ çš„ï¼‰çš„å»ºè®®

#### 1. ç®€åŒ–LEDæ§åˆ¶é€»è¾‘
```c
// å½“å‰ä»£ç ï¼ˆ34è¡Œï¼‰
if(Temperature_Data > TMAX)
{
    Led_Level = 3;
    ucLed[0] = 1;
}
else
{
    ucLed[0] = 0;
}
// ... é‡å¤é€»è¾‘

// ä¼˜åŒ–å»ºè®®ï¼ˆå€Ÿé‰´èŒƒä¾‹ï¼‰
ucLed[0] = (Temperature_Data > TMAX);
ucLed[1] = (Temperature_Data >= TMIN) && (Temperature_Data <= TMAX);
ucLed[2] = (Temperature_Data < TMIN);
ucLed[3] = Data_Error;

// PWMç­‰çº§
if(Temperature_Data > TMAX)
    Led_Level = 3;
else if(Temperature_Data >= TMIN)
    Led_Level = 6;
else
    Led_Level = 9;
```

#### 2. ç»Ÿä¸€é•¿æŒ‰æœºåˆ¶
```c
// å½“å‰ï¼šä¸¤ä¸ªæŒ‰é”®ç‹¬ç«‹è®¡æ•°
unsigned int Key_Long0;
unsigned int Key_Long1;

// å»ºè®®ï¼šå€Ÿé‰´èŒƒä¾‹çš„ç»Ÿä¸€æ ‡å¿—ä½
bit Time_Flag;
unsigned int Long_Press_Counter;
```

#### 3. ä¼˜åŒ–å‚æ•°æ•°ç»„ç»“æ„
```c
// å½“å‰ï¼š4ä½æ•°ç»„
unsigned char Temperature_Setting[4] = {3,0,2,0};

// å»ºè®®ï¼šæ”¹ä¸º2ä½æ•°ç»„ï¼ˆå€Ÿé‰´èŒƒä¾‹ï¼‰
unsigned char TMAX_Setting = 30;
unsigned char TMIN_Setting = 20;
// æˆ–
unsigned char Temp_Setting[2] = {30, 20};
```

---

### å¯¹é¡¹ç›®Bï¼ˆèŒƒä¾‹ï¼‰çš„å»ºè®®

#### 1. é¿å…æµ®ç‚¹è¿ç®—ï¼ˆå¦‚æœ‰ä»£ç ä½“ç§¯é™åˆ¶ï¼‰
```c
// å½“å‰ï¼šä½¿ç”¨float
float Temperature;

// å»ºè®®ï¼šæ”¹ä¸ºæ•´æ•°ï¼ˆå¦‚ä½ çš„é¡¹ç›®ï¼‰
unsigned char Temperature_Real[3];
```

#### 2. å¢åŠ æ³¨é‡Šè¯¦ç»†åº¦
```c
// å½“å‰ï¼šç®€æ´æ³¨é‡Š
unsigned char Parameter[2] = {30,20};

// å»ºè®®ï¼šè¯¦ç»†æ³¨é‡Š
unsigned char Parameter[2] = {30,20};  // [0]=ä¸Šé™(TMAX), [1]=ä¸‹é™(TMIN)
```

#### 3. æ”¾å®½è¾“å…¥éªŒè¯è§„åˆ™
```c
// å½“å‰ï¼šå¿…é¡»è¾“å…¥å°æ•°ç‚¹
if(Point_Flag == 0 || Seg_Input_Index < 3)
{
    // æ¸…é™¤æ•°æ®
}

// å»ºè®®ï¼šæ”¯æŒæ•´æ•°è¾“å…¥ï¼ˆå¦‚ä½ çš„é¡¹ç›®ï¼‰
```

---

## ğŸ† æœ€ä½³å®è·µæ€»ç»“

### ä»èŒƒä¾‹ç¨‹åºå­¦ä¹ çš„ä¼˜ç‚¹
1. âœ… **ä»£ç ç®€æ´æ€§**ï¼šä½¿ç”¨è¡¨è¾¾å¼å’Œä½è¿ç®—å‡å°‘ä»£ç è¡Œæ•°
2. âœ… **æ•°æ®ç»“æ„**ï¼šParameter[2]æ¯”å››ä½æ•°ç»„æ›´ç´§å‡‘
3. âœ… **é•¿æŒ‰æœºåˆ¶**ï¼šåŸºäºæ ‡å¿—ä½çš„è®¾è®¡æ›´é€šç”¨

### ä½ çš„é¡¹ç›®çš„ä¼˜åŠ¿
1. âœ… **æ— æµ®ç‚¹è¿ç®—**ï¼šå‡å°‘ä»£ç ä½“ç§¯ï¼Œæé«˜è¿è¡Œæ•ˆç‡
2. âœ… **å¯è¯»æ€§å¼º**ï¼šæ¸…æ™°çš„if-elseç»“æ„ï¼Œæ˜“äºç†è§£
3. âœ… **æ³¨é‡Šè¯¦ç»†**ï¼šæ¯ä¸ªå˜é‡å’Œé€»è¾‘éƒ½æœ‰è¯´æ˜
4. âœ… **å˜é‡å‘½å**ï¼š`Led_Level`æ¯”`Led_Pwm`æ›´è¯­ä¹‰åŒ–
5. âœ… **çµæ´»è¾“å…¥**ï¼šæ”¯æŒæ•´æ•°å’Œå°æ•°ä¸¤ç§è¾“å…¥æ–¹å¼

---

## ğŸ“ å­¦ä¹ è¦ç‚¹

### 1. åµŒå…¥å¼ç³»ç»Ÿè®¾è®¡æƒè¡¡
- **ä»£ç ä½“ç§¯ vs å¯è¯»æ€§**ï¼šèŒƒä¾‹æ›´ç®€æ´ï¼Œä½ çš„æ›´æ¸…æ™°
- **è¿è¡Œæ•ˆç‡ vs å¼€å‘æ•ˆç‡**ï¼šæ•´æ•°è¿ç®—æ›´å¿«ï¼Œæµ®ç‚¹è¿ç®—æ›´ç›´è§‚
- **çµæ´»æ€§ vs ä¸¥æ ¼æ€§**ï¼šä½ çš„è¾“å…¥æ›´çµæ´»ï¼ŒèŒƒä¾‹æ›´ä¸¥æ ¼

### 2. ä»£ç é£æ ¼
- **èŒƒä¾‹é£æ ¼**ï¼šé€‚åˆè¿½æ±‚ä»£ç ç®€æ´çš„åœºæ™¯
- **ä½ çš„é£æ ¼**ï¼šé€‚åˆå›¢é˜Ÿåä½œå’Œé•¿æœŸç»´æŠ¤

### 3. ç®—æ³•é€‰æ‹©
- **å››èˆäº”å…¥**ï¼š
  - æµ®ç‚¹ï¼šç®€å•ç›´è§‚ï¼Œä½†éœ€è¦åº“æ”¯æŒ
  - æ•´æ•°ï¼šå¤æ‚ä½†é«˜æ•ˆï¼Œé€‚åˆèµ„æºå—é™åœºæ™¯

### 4. çŠ¶æ€æœºè®¾è®¡
- ä¸¤ä¸ªé¡¹ç›®éƒ½é‡‡ç”¨äº†æ¸…æ™°çš„çŠ¶æ€æœºè®¾è®¡ï¼ˆæ¨¡å¼0/1/2ï¼‰
- çŠ¶æ€è½¬ç§»é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•

---

## ğŸ“ ç»“è®º

### ä¸¤ä¸ªé¡¹ç›®éƒ½æ˜¯ä¼˜ç§€çš„å®ç°ï¼

- **èŒƒä¾‹ç¨‹åº**ï¼šä»£ç ç®€æ´ï¼Œé€‚åˆå­¦ä¹ åµŒå…¥å¼ç¼–ç¨‹æŠ€å·§
- **ä½ çš„é¡¹ç›®**ï¼šé€»è¾‘æ¸…æ™°ï¼Œé€‚åˆå®é™…å·¥ç¨‹åº”ç”¨

### æ ¸å¿ƒç›¸åŒç‚¹
- âœ… é©±åŠ¨å±‚ä»£ç 100%ç›¸åŒ
- âœ… æ•´ä½“æ¶æ„å’ŒåŠŸèƒ½å®Œå…¨ä¸€è‡´
- âœ… æŒ‰é”®é˜²æŠ–ã€å®šæ—¶å™¨ã€PWMç­‰æœºåˆ¶ç›¸åŒ

### ä¸»è¦å·®å¼‚
- âš¡ æ¸©åº¦æ•°æ®å¤„ç†ï¼šæµ®ç‚¹ vs æ•´æ•°
- âš¡ ä»£ç é£æ ¼ï¼šç®€æ´ vs è¯¦ç»†
- âš¡ å‚æ•°ç»“æ„ï¼šç´§å‡‘ vs ç›´è§‚

### æ¨èå­¦ä¹ è·¯å¾„
1. **ç†è§£èŒƒä¾‹çš„ç®€æ´æ€§**ï¼šå­¦ä¹ ä½è¿ç®—å’Œè¡¨è¾¾å¼ä¼˜åŒ–
2. **ä¿æŒä½ çš„å¯è¯»æ€§**ï¼šæ¸…æ™°çš„ä»£ç æ›´æ˜“ç»´æŠ¤
3. **èåˆä¸¤è€…ä¼˜ç‚¹**ï¼šæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©æœ€ä½³æ–¹æ¡ˆ

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2026-01-31
**å¯¹æ¯”é¡¹ç›®**ï¼šdemo5 vs è¿‡æ¸¡è®­ç»ƒèŒƒä¾‹ç¨‹åº
**åˆ†ææ·±åº¦**ï¼šé©±åŠ¨å±‚ã€åº”ç”¨å±‚ã€ç®—æ³•å®ç°ã€ä»£ç é£æ ¼
