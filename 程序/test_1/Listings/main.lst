C51 COMPILER V9.59.0.0   MAIN                                                              06/19/2025 12:24:04 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\keilc51\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*头文件声明区*/
   2          #include <REGX52.H>
   3          #include <intrins.h>
   4          /*变量声明区*/
   5          unsigned char Seg_Dula[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x00};
   6          unsigned char Seg_Wela[]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf};
   7          unsigned char Seg_Pos;
   8          unsigned char Seg_Buf[]={1,2,3,4,5,6};
   9          unsigned char ucled=0xfe;
  10          unsigned int xms;
  11          unsigned char temp=0;
  12          unsigned char Key_Val,Key_Down,Key_Up,Key_Old;
  13          bit System_Flag;
  14          /*延时函数*/
  15          void Delay(xms)   //@12.000MHz
  16          {
  17   1        unsigned char i, j;
  18   1      
  19   1        i = 2;
  20   1        j = 239;
  21   1        do
  22   1        {
  23   2          while (--j);
  24   2        } while (--i);
  25   1      }
  26          
  27          /*独立按键读取函数*/
  28          unsigned char Key_Read0()
  29          {
  30   1        
  31   1        if(P3_4==0) temp=1;
  32   1        if(P3_5==0) temp=2;
  33   1        if(P3_6==0) temp=3;
  34   1        if(P3_7==0) temp=4;
  35   1        return temp;
  36   1      }
  37          
  38          /*矩阵按键*/
  39          unsigned char Key_Read1()
  40          {
  41   1        P3_0=0;P3_1=1;P3_2=1;P3_3=1;
  42   1        if(P3_4==0) temp=1;
  43   1        if(P3_5==0) temp=2;
  44   1        if(P3_6==0) temp=3;
  45   1        if(P3_7==0) temp=4;
  46   1        P3_0=1;P3_1=0;P3_2=1;P3_3=1;
  47   1        if(P3_4==0) temp=5;
  48   1        if(P3_5==0) temp=6;
  49   1        if(P3_6==0) temp=7;
  50   1        if(P3_7==0) temp=8;
  51   1        P3_0=1;P3_1=1;P3_2=0;P3_3=1;
  52   1        if(P3_4==0) temp=9;
  53   1        if(P3_5==0) temp=10;
  54   1        if(P3_6==0) temp=11;
C51 COMPILER V9.59.0.0   MAIN                                                              06/19/2025 12:24:04 PAGE 2   

  55   1        if(P3_7==0) temp=12;
  56   1        P3_0=1;P3_1=1;P3_2=1;P3_3=0;
  57   1        if(P3_4==0) temp=13;
  58   1        if(P3_5==0) temp=14;
  59   1        if(P3_6==0) temp=15;
  60   1        if(P3_7==0) temp=16;
  61   1        return temp;
  62   1      }
  63          
  64          /*数码管显示函数*/
  65          void Seg_Disp(unsigned char wela,dula)
  66          {
  67   1        P0=0x00;
  68   1        P2_6=1;
  69   1        P2_6=0;
  70   1        
  71   1        P0=Seg_Wela[wela];
  72   1        P2_7=1;
  73   1        P2_7=0;
  74   1        
  75   1        P0=Seg_Dula[dula];
  76   1        P2_6=1;
  77   1        P2_6=0;
  78   1      }
  79          /*定时器初始化函数*/
  80          void Timer0Init(void)   //1毫秒@12.000MHz
  81          {
  82   1      
  83   1        TMOD &= 0xF0;   //设置定时器模式
  84   1        TMOD |= 0x01;   //设置定时器模式
  85   1        TL0 = 0x18;   //设置定时初始值
  86   1        TH0 = 0xFC;   //设置定时初始值
  87   1        TF0 = 0;    //清除TF0标志
  88   1        TR0 = 1;    //定时器0开始计时
  89   1        ET0=1;
  90   1        EA=1;
  91   1      }
  92          /*定时器0中断服务函数*/
  93          void Timer0Server() interrupt 1
  94          {
  95   1        TL0=0x18;
  96   1        TH0=0xFC;
  97   1        if(++Seg_Pos==6) Seg_Pos=0;
  98   1        Seg_Disp(Seg_Pos,Seg_Buf[Seg_Pos]);
  99   1      }
 100          /*Main*/
 101          void main()
 102          {
 103   1        Timer0Init();
 104   1        while(1)
 105   1        {
 106   2          Key_Val=Key_Read1();
 107   2          Key_Down=Key_Val&(Key_Val^Key_Old);
 108   2          Key_Up=~Key_Val&(Key_Val^Key_Old);
 109   2          Key_Old=Key_Val;
 110   2          
 111   2          
 112   2          if(System_Flag==1)
 113   2          {
 114   3            ucled=_crol_(ucled,1);
 115   3            P1=ucled;
 116   3            Delay(500);
C51 COMPILER V9.59.0.0   MAIN                                                              06/19/2025 12:24:04 PAGE 3   

 117   3          }
 118   2          switch(Key_Down)
 119   2          {
 120   3            case 1:
 121   3            System_Flag=1;
 122   3            break;
 123   3            case 2:
 124   3            System_Flag=0;
 125   3            break;
 126   3          }
 127   2          
 128   2        }
 129   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    348    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     32       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
